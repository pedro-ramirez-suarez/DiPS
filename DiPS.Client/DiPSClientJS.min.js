var diPSClient={websocket:null,Ready:!1,Error:!1,Url:"",ClientId:"",Subscriptions:new Array,Publish:function(i,e){var n={EventName:i,ClientId:diPSClient.ClientId,MessageType:"publish",EventParameter:JSON.stringify(e)};diPSClient.waitForSocketReady(JSON.stringify(n))},Subscribe:function(i,e){if(void 0==diPSClient.Subscriptions[i]){diPSClient.Subscriptions[i]=e;var n={EventName:i,ClientId:diPSClient.ClientId,MessageType:"subscribe"},t=JSON.stringify(n);diPSClient.waitForSocketReady(t)}},Unubscribe:function(i){if(void 0!=diPSClient.Subscriptions[i]){diPSClient.Subscriptions[i]=void 0;var e={EventName:i,ClientId:diPSClient.ClientId,MessageType:"unsubscribe"};diPSClient.waitForSocketReady(JSON.stringify(e))}},Connect:function(i){diPSClient.ClientId=diPSClient.createGuid(),diPSClient.Url=i+"/?clientid="+diPSClient.ClientId,diPSClient.websocket=new WebSocket(diPSClient.Url),diPSClient.websocket.onopen=function(i){diPSClient.Ready=!0},diPSClient.websocket.onclose=function(i){diPSClient.Ready=!1},diPSClient.websocket.onmessage=function(i){var e=JSON.parse(i.data);"eventfired"==e.MessageType&&null!=diPSClient.Subscriptions[e.EventName]&&diPSClient.Subscriptions[e.EventName](e.PayLoad)},diPSClient.websocket.onerror=function(i){diPSClient.Error=!0,console.log(i)}},Disconnect:function(){diPSClient.websocket.close()},createGuid:function(){function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()},waitForSocketReady:function(i){var e=diPSClient.websocket;return void 0!=e&&null!=e&&1===e.readyState?void e.send(i):void setTimeout(function(){diPSClient.waitForSocketReady(i)},5)}};